const XLSX = require('xlsx');
const fs = require('fs');
const path = require('path');

// Create workbook
const wb = XLSX.utils.book_new();

// Sheet 1: System Overview
const overviewData = [
  ['INTELEVO - AI-POWERED LEARNING MANAGEMENT SYSTEM'],
  [''],
  ['Category', 'Details'],
  ['System Name', 'Intelevo'],
  ['Type', 'AI-Powered Learning Management System (LMS)'],
  ['Primary Technology', 'Next.js 15, MongoDB, Firebase, Google Gemini AI'],
  ['ML Accuracy', '88% (R¬≤ score)'],
  ['AI Modes', '8 Personalized Learning Modes'],
  ['Learning Model', 'Felder-Silverman Learning Style Model (FSLSM)'],
  ['Authentication', 'JWT (httpOnly cookies) + Firebase Auth'],
  ['Cloud Storage', 'Backblaze B2 (primary) + Firebase Storage (profile photos)'],
  ['ML Service', 'Python Flask (Port 5000) with XGBoost models'],
  [''],
  ['KEY FEATURES'],
  ['Feature', 'Description'],
  ['Machine Learning Classification', 'Automatically detects learning styles with 88% accuracy'],
  ['8 AI Learning Modes', 'Personalized content generation for different learning preferences'],
  ['Hybrid Intelligence', 'Combines questionnaire + behavioral tracking + ML'],
  ['Real-time Collaboration', 'Course management, assignments, discussions'],
  ['Document Processing', 'PDF, DOCX, PPTX with AI-powered learning modes'],
  ['Behavioral Tracking', '24 features tracked across 4 FSLSM dimensions'],
];

const ws_overview = XLSX.utils.aoa_to_sheet(overviewData);
ws_overview['!cols'] = [{ wch: 30 }, { wch: 80 }];
XLSX.utils.book_append_sheet(wb, ws_overview, 'System Overview');

// Sheet 2: User Journey Flow
const journeyData = [
  ['COMPLETE USER JOURNEY - STEP BY STEP'],
  [''],
  ['Phase', 'Step', 'Page/Route', 'Description', 'Duration', 'Key Actions'],
  ['1. LANDING & AUTH', '1.1', '/', 'Landing Page - First Impression', '2-3 min', 'View features, See 8 AI modes showcase, Click "Get Started"'],
  ['1. LANDING & AUTH', '1.2', '/register', 'Registration Form', '3-5 min', 'Fill name, email, password, Accept terms'],
  ['1. LANDING & AUTH', '1.3', '/register (Step 2)', 'Email Verification', '1-2 min', 'Enter OTP code from email'],
  ['1. LANDING & AUTH', '1.4', '/login', 'Login', '1 min', 'Enter credentials or use Google Sign-In'],
  [''],
  ['2. ONBOARDING', '2.1', '/home', 'Home Dashboard', '2-3 min', 'View welcome message, See course overview, Check calendar'],
  ['2. ONBOARDING', '2.2', '/questionnaire', 'Learning Style Questionnaire', '5 min', 'Answer 20 questions across 4 FSLSM dimensions'],
  ['2. ONBOARDING', '2.3', '/my-learning-style', 'View Learning Style Results', '2-3 min', 'See FSLSM scores, View recommended AI modes, Read learning tips'],
  [''],
  ['3. COURSE SETUP', '3.1', '/courses', 'Browse Courses', '2-5 min', 'View all courses, Filter/search, Create or join course'],
  ['3. COURSE SETUP', '3.2', '/courses (Create)', 'Create New Course', '3-5 min', 'Enter course details, Set color theme, Add description'],
  ['3. COURSE SETUP', '3.3', '/courses (Join)', 'Join Existing Course', '1-2 min', 'Enter course code, Confirm enrollment'],
  [''],
  ['4. COURSE USAGE', '4.1', '/courses/[id]', 'Course Detail - Stream Tab', '5-10 min', 'View announcements, Read posts, Add comments'],
  ['4. COURSE USAGE', '4.2', '/courses/[id]', 'Course Detail - Classwork Tab', '10-20 min', 'View assignments, Upload materials, Submit work'],
  ['4. COURSE USAGE', '4.3', '/courses/[id]', 'Course Detail - People Tab', '2-3 min', 'View members, Invite students, Manage access'],
  [''],
  ['5. LEARNING SESSION', '5.1', 'Document Viewer', 'Open Learning Material', '1 min', 'Click on PDF/DOCX/PPTX file'],
  ['5. LEARNING SESSION', '5.2', 'Document Viewer', 'View AI Mode Recommendations', '30 sec', 'See 2-3 recommended modes based on content'],
  ['5. LEARNING SESSION', '5.3', 'AI Mode Panel', 'Select AI Learning Mode', '20-60 min', 'Choose from 8 AI modes, Study with personalized content'],
  ['5. LEARNING SESSION', '5.4', 'Document Viewer', 'Complete Assignment', '5-10 min', 'Finish studying, Submit work, Add notes'],
  [''],
  ['6. ML TRACKING', '6.1', 'Background Process', 'Behavioral Tracking (Week 1-2)', 'Continuous', 'System tracks mode usage, time spent, interactions'],
  ['6. ML TRACKING', '6.2', 'ML Service', 'ML Classification (Week 3+)', 'Automatic', 'ML model analyzes 24 features, Updates recommendations'],
  ['6. ML TRACKING', '6.3', '/my-learning-style', 'View Updated Profile', '2-3 min', 'See improved accuracy, Check new recommendations'],
  [''],
  ['7. ONGOING USE', '7.1', '/schedule', 'Manage Schedule', '3-5 min', 'View calendar, Check deadlines, Plan study time'],
  ['7.2', '/settings', 'Update Settings', '5-10 min', 'Change profile, Update password, Set preferences'],
  ['7.3', '/home', 'Daily Dashboard Check', '2-3 min', 'Check upcoming tasks, View progress, Access courses'],
];

const ws_journey = XLSX.utils.aoa_to_sheet(journeyData);
ws_journey['!cols'] = [{ wch: 20 }, { wch: 8 }, { wch: 25 }, { wch: 40 }, { wch: 12 }, { wch: 60 }];
XLSX.utils.book_append_sheet(wb, ws_journey, 'User Journey Flow');

// Sheet 3: 8 AI Learning Modes
const aiModesData = [
  ['8 AI LEARNING MODES - DETAILED BREAKDOWN'],
  [''],
  ['Mode', 'Icon', 'Tagline', 'Description', 'Key Features', 'Best For', 'Technology', 'FSLSM Dimension'],
  ['1. AI Narrator', 'üéß', 'Listen & Learn in Taglish', 'AI-powered audio narration with interactive quizzes, study tips, and summaries in Taglish (English + Tagalog)', 'Audio Narration, Interactive Quizzes, Study Tips, Document Summaries', 'Auditory learners, Multitasking, Language learners', 'Google TTS + Gemini AI', 'Verbal'],
  ['2. Visual Learning', 'üìä', 'See Concepts Come Alive', 'Transform complex ideas into stunning diagrams, infographics, mind maps, and flowcharts', 'AI Diagrams, Infographics, Mind Maps, Flowcharts (Mermaid)', 'Visual learners, Complex concepts, Data relationships', 'Gemini Image Generation', 'Visual'],
  ['3. Active Learning Hub', 'üéØ', 'Learn by Doing', 'Hands-on activities, simulated discussions, and real-world scenarios for active learners', 'Interactive Activities, Group Simulations, Real Scenarios, Immediate Practice', 'Active learners, Group-oriented, Experiential learning', 'Gemini Flash Lite (FSLSM-based)', 'Active'],
  ['4. Concept Constellation', 'üîÆ', 'Discover Hidden Patterns', 'Explore concept universes, discover patterns, and unlock creative insights', 'Pattern Discovery, Concept Universe, Creative Insights, Innovation Ideas', 'Intuitive learners, Abstract thinkers, Pattern recognition', 'Abstract Pattern AI', 'Intuitive'],
  ['5. Hands-On Lab', 'üî¨', 'Experiment & Explore', 'Interactive simulations, practical challenges, and step-by-step laboratory experiences', 'Virtual Labs, Simulations, Practical Challenges, Real Experiments', 'Sensing learners, Practical thinkers, Technical content', 'Interactive Simulation Engine', 'Sensing'],
  ['6. Global Learning', 'üåç', 'See the Big Picture', 'Holistic overviews, system interconnections, and comprehensive understanding', 'Big Picture View, Interconnections, System Dynamics, Context Mapping', 'Global learners, System thinking, Holistic perspective', 'Holistic AI Analysis', 'Global'],
  ['7. Sequential Learning', 'üìã', 'Step-by-Step Mastery', 'Logical progression, concept dependencies, and structured learning flows', 'Step Breakdown, Concept Flow, Dependencies, Progress Tracking', 'Sequential learners, Systematic approach, Procedural content', 'Sequential AI Processing', 'Sequential'],
  ['8. Reflective Learning', 'ü§î', 'Think Deep, Learn Deeper', 'Deep contemplation, self-assessment, and metacognitive awareness tracking', 'Deep Analysis, Self-Assessment, Thought Evolution, Metacognition', 'Reflective learners, Individual study, Critical analysis', 'Reflective AI Mentor', 'Reflective'],
  [''],
  ['AI MODE RECOMMENDATION SYSTEM'],
  ['Feature', 'Description'],
  ['Content Analysis', 'AI analyzes document content, type, complexity, and learning objectives'],
  ['Matching Algorithm', 'Matches content characteristics to learning mode strengths'],
  ['Recommendations', 'Returns 2-3 most suitable modes with reasoning'],
  ['Adaptation', 'Learns from user behavior to improve recommendations over time'],
];

const ws_modes = XLSX.utils.aoa_to_sheet(aiModesData);
ws_modes['!cols'] = [{ wch: 25 }, { wch: 8 }, { wch: 25 }, { wch: 60 }, { wch: 50 }, { wch: 40 }, { wch: 30 }, { wch: 15 }];
XLSX.utils.book_append_sheet(wb, ws_modes, '8 AI Learning Modes');

// Sheet 4: ML Classification System
const mlSystemData = [
  ['MACHINE LEARNING CLASSIFICATION SYSTEM'],
  [''],
  ['THREE-TIER HYBRID APPROACH'],
  [''],
  ['Tier', 'Name', 'Timing', 'Accuracy', 'Method', 'Purpose', 'User Experience'],
  ['1', 'Questionnaire Classification', 'Day 1 (5 minutes)', '60-70%', '20-question ILS questionnaire', 'Solve cold start problem', 'Immediate personalization'],
  ['2', 'Behavioral Tracking', 'Week 1-2 (Continuous)', 'Building data', 'Track 24 behavioral features', 'Collect training data', 'Silent background process'],
  ['3', 'ML Classification', 'Week 3+ (Automatic)', '88% (R¬≤ score)', 'XGBoost model analysis', 'Highest accuracy classification', 'Automatic recommendation updates'],
  [''],
  ['FELDER-SILVERMAN LEARNING STYLE MODEL (FSLSM)'],
  [''],
  ['Dimension', 'Left Pole', 'Right Pole', 'Description', 'Questions', 'Score Range'],
  ['1. Active ‚Üî Reflective', 'Active', 'Reflective', 'How do you process information?', '5', '-11 to +11'],
  ['', 'Active: Learn by doing, group work', 'Reflective: Learn by thinking, individual work', '', '', ''],
  ['2. Sensing ‚Üî Intuitive', 'Sensing', 'Intuitive', 'What type of information do you prefer?', '5', '-11 to +11'],
  ['', 'Sensing: Concrete, practical, facts', 'Intuitive: Abstract, innovative, theories', '', '', ''],
  ['3. Visual ‚Üî Verbal', 'Visual', 'Verbal', 'How do you prefer information presented?', '5', '-11 to +11'],
  ['', 'Visual: Pictures, diagrams, charts', 'Verbal: Written and spoken words', '', '', ''],
  ['4. Sequential ‚Üî Global', 'Sequential', 'Global', 'How do you progress toward understanding?', '5', '-11 to +11'],
  ['', 'Sequential: Linear, step-by-step', 'Global: Holistic, big picture', '', '', ''],
  [''],
  ['24 BEHAVIORAL FEATURES TRACKED'],
  [''],
  ['Category', 'Features', 'Examples'],
  ['Active/Reflective', '6 features', 'activeModeRatio, questionsGenerated, debatesParticipated, reflectiveModeRatio, reflectionsWritten, journalEntries'],
  ['Sensing/Intuitive', '6 features', 'sensingModeRatio, simulationsCompleted, challengesCompleted, intuitiveModeRatio, conceptsExplored, patternsDiscovered'],
  ['Visual/Verbal', '6 features', 'visualModeRatio, diagramsViewed, wireframesExplored, verbalModeRatio, textRead, summariesCreated'],
  ['Sequential/Global', '6 features', 'sequentialModeRatio, stepsCompleted, linearNavigation, globalModeRatio, overviewsViewed, navigationJumps'],
  [''],
  ['ML MODEL SPECIFICATIONS'],
  [''],
  ['Specification', 'Value'],
  ['Algorithm', 'XGBoost (Extreme Gradient Boosting)'],
  ['Models', '4 separate models (one per FSLSM dimension)'],
  ['Training Data', '2,500+ samples'],
  ['Validation Accuracy', '88% (R¬≤ score)'],
  ['Input Features', '24 behavioral metrics'],
  ['Output', 'Score for each dimension (-11 to +11)'],
  ['Deployment', 'Python Flask service (Port 5000)'],
  ['Update Frequency', 'Continuous (as user interacts)'],
];

const ws_ml = XLSX.utils.aoa_to_sheet(mlSystemData);
ws_ml['!cols'] = [{ wch: 25 }, { wch: 30 }, { wch: 20 }, { wch: 15 }, { wch: 40 }, { wch: 30 }, { wch: 35 }];
XLSX.utils.book_append_sheet(wb, ws_ml, 'ML Classification System');

// Sheet 5: Pages & Routes
const pagesData = [
  ['COMPLETE PAGE & ROUTE STRUCTURE'],
  [''],
  ['Category', 'Route', 'Page Name', 'Access Level', 'Key Features', 'Components Used'],
  ['Landing', '/', 'Landing Page', 'Public', 'Feature showcase, 8 AI modes carousel, Stats display, CTA buttons', 'Neural network animation, Mode cards'],
  [''],
  ['Authentication', '/login', 'Login Page', 'Public', 'Email/password login, Google Sign-In, Remember me', 'Firebase Auth, JWT tokens'],
  ['Authentication', '/register', 'Registration Page', 'Public', 'Multi-step form, Email verification, OTP validation', 'Terms/Privacy modals'],
  ['Authentication', '/forgot-password', 'Forgot Password', 'Public', 'Password reset request', 'Email service'],
  ['Authentication', '/reset-password', 'Reset Password', 'Public', 'Set new password with token', 'Token validation'],
  [''],
  ['Dashboard', '/home', 'Home Dashboard', 'Authenticated', 'Welcome header, Course carousel, Upcoming tasks, Calendar widget', 'Course cards, Task sidebar'],
  [''],
  ['Courses', '/courses', 'All Courses', 'Authenticated', 'Course grid/list, Filter/sort, Drag-drop reorder, Search', 'ProfessionalCourseCard, Filters'],
  ['Courses', '/courses/[id]', 'Course Detail', 'Enrolled/Creator', 'Stream/Classwork/People tabs, Announcements, Assignments', 'StreamTab, ClassworkTab, Sidebar'],
  ['Courses', '/courses/join', 'Join Course', 'Authenticated', 'Enter course code, Confirm enrollment', 'Join modal'],
  [''],
  ['Learning', '/questionnaire', 'Learning Style Quiz', 'Authenticated', '20 FSLSM questions, Progress bar, Pagination', 'Question cards, Navigation'],
  ['Learning', '/my-learning-style', 'Learning Style Dashboard', 'Authenticated', 'FSLSM scores, Recommendations, Learning tips', 'LearningStyleDashboard'],
  [''],
  ['Schedule', '/schedule', 'Schedule Page', 'Authenticated', 'Calendar view, Course schedules, Upcoming classes', 'Calendar component'],
  [''],
  ['Settings', '/settings', 'Settings Page', 'Authenticated', 'Profile, Account security, Preferences', 'ProfileSettings, AccountSettings'],
  ['Settings', '/settings (Profile)', 'Profile Settings', 'Authenticated', 'Update name/email, Upload profile picture', 'ProfilePictureUpload'],
  ['Settings', '/settings (Security)', 'Account Security', 'Authenticated', 'Change password, 2FA, Session management', 'Password form'],
  [''],
  ['Admin', '/admin', 'Admin Dashboard', 'Admin only', 'System overview, User stats, Course analytics', 'Admin layout'],
  ['Admin', '/admin/users', 'User Management', 'Admin only', 'View/edit/delete users, Role management', 'User table'],
  ['Admin', '/admin/courses', 'Course Management', 'Admin only', 'View all courses, Moderate content', 'Course list'],
  ['Admin', '/admin/settings', 'System Settings', 'Admin only', 'Platform configuration, Feature toggles', 'Settings form'],
  [''],
  ['Document Viewer', 'Modal/Panel', 'PDF Viewer', 'Enrolled', 'PDF preview, 8 AI modes toolbar, Page navigation', 'PdfPreviewWithAI'],
  ['Document Viewer', 'Modal/Panel', 'DOCX Viewer', 'Enrolled', 'DOCX preview, 8 AI modes toolbar, Formatting', 'DocxPreviewWithAI'],
  ['Document Viewer', 'Modal/Panel', 'PPTX Viewer', 'Enrolled', 'Slide preview, 8 AI modes toolbar, Navigation', 'CleanPDFViewer'],
  [''],
  ['Testing', '/test-*', 'Test Pages', 'Development', 'Various testing pages for features', 'Multiple test components'],
];

const ws_pages = XLSX.utils.aoa_to_sheet(pagesData);
ws_pages['!cols'] = [{ wch: 20 }, { wch: 25 }, { wch: 25 }, { wch: 15 }, { wch: 60 }, { wch: 40 }];
XLSX.utils.book_append_sheet(wb, ws_pages, 'Pages & Routes');

// Sheet 6: API Endpoints
const apiData = [
  ['API ENDPOINTS REFERENCE'],
  [''],
  ['Category', 'Method', 'Endpoint', 'Description', 'Request Body', 'Response', 'Auth Required'],
  ['Authentication', 'POST', '/api/auth/register', 'Register new user', 'name, email, password', 'Success message, OTP sent', 'No'],
  ['Authentication', 'POST', '/api/auth/verify-otp', 'Verify email OTP', 'email, otp', 'Success/error', 'No'],
  ['Authentication', 'POST', '/api/auth/login', 'Login user', 'email, password', 'JWT token (httpOnly cookie)', 'No'],
  ['Authentication', 'POST', '/api/auth/google-signin', 'Google Sign-In', 'firebaseUser object', 'JWT token', 'No'],
  ['Authentication', 'GET', '/api/auth/profile', 'Get user profile', 'None', 'User data', 'Yes'],
  ['Authentication', 'PUT', '/api/auth/profile', 'Update profile', 'name, email, etc.', 'Updated user', 'Yes'],
  ['Authentication', 'POST', '/api/auth/change-password', 'Change password', 'currentPassword, newPassword', 'Success message', 'Yes'],
  ['Authentication', 'POST', '/api/auth/profile/picture', 'Upload profile picture', 'FormData (image file)', 'Image URL', 'Yes'],
  [''],
  ['Courses', 'GET', '/api/courses', 'Get user courses', 'None', 'Array of courses', 'Yes'],
  ['Courses', 'POST', '/api/courses', 'Create course', 'subject, section, teacherName, etc.', 'New course object', 'Yes'],
  ['Courses', 'GET', '/api/courses/[id]', 'Get course details', 'None', 'Course object', 'Yes'],
  ['Courses', 'PUT', '/api/courses/[id]', 'Update course', 'Course fields', 'Updated course', 'Yes (Creator)'],
  ['Courses', 'DELETE', '/api/courses/[id]', 'Archive course', 'None', 'Success message', 'Yes (Creator)'],
  ['Courses', 'POST', '/api/courses/reorder', 'Reorder courses', 'courseIds array', 'Success', 'Yes'],
  ['Courses', 'POST', '/api/courses/[id]/invite', 'Invite user to course', 'email, role', 'Success message', 'Yes (Creator)'],
  ['Courses', 'GET', '/api/courses/[id]/people', 'Get course members', 'None', 'Teachers and students', 'Yes'],
  ['Courses', 'DELETE', '/api/courses/[id]/people', 'Remove member', 'userId, role', 'Success', 'Yes (Creator)'],
  [''],
  ['Classwork', 'GET', '/api/courses/[id]/classwork', 'Get classwork', 'None', 'Array of assignments', 'Yes'],
  ['Classwork', 'POST', '/api/courses/[id]/classwork', 'Create classwork', 'title, description, type, etc.', 'New classwork', 'Yes (Creator)'],
  ['Classwork', 'DELETE', '/api/classwork/[id]', 'Delete classwork', 'None', 'Success', 'Yes (Creator)'],
  ['Classwork', 'GET', '/api/classwork/[id]/submissions', 'Get submissions', 'None', 'Array of submissions', 'Yes'],
  ['Classwork', 'POST', '/api/classwork/[id]/submit', 'Submit work', 'content, files', 'Submission object', 'Yes'],
  [''],
  ['Announcements', 'GET', '/api/courses/[id]/announcements', 'Get announcements', 'None', 'Array of announcements', 'Yes'],
  ['Announcements', 'POST', '/api/courses/[id]/announcements', 'Post announcement', 'content', 'New announcement', 'Yes (Creator)'],
  ['Announcements', 'DELETE', '/api/courses/[id]/announcements', 'Delete announcement', 'announcementId', 'Success', 'Yes (Creator)'],
  ['Announcements', 'POST', '/api/courses/[id]/announcements/[aid]/comments', 'Add comment', 'content', 'New comment', 'Yes'],
  [''],
  ['Learning Style', 'GET', '/api/learning-style/questionnaire', 'Get questionnaire', 'None', '20 FSLSM questions', 'Yes'],
  ['Learning Style', 'POST', '/api/learning-style/questionnaire', 'Submit questionnaire', 'responses object', 'FSLSM scores', 'Yes'],
  ['Learning Style', 'GET', '/api/learning-style/profile', 'Get learning profile', 'None', 'User learning style data', 'Yes'],
  ['Learning Style', 'POST', '/api/learning-style/classify', 'Classify learning style', 'features array (24)', 'FSLSM predictions', 'Yes'],
  [''],
  ['Learning Behavior', 'POST', '/api/learning-behavior/track', 'Track behavior', 'Behavior data', 'Success', 'Yes'],
  [''],
  ['AI Modes', 'POST', '/api/ai-tutor/generate-audio', 'Generate audio narration', 'content', 'Audio URL, quiz, tips', 'Yes'],
  ['AI Modes', 'POST', '/api/visual-content/generate', 'Generate visual content', 'content', 'Diagrams, mind maps', 'Yes'],
  ['AI Modes', 'POST', '/api/active-learning/generate', 'Generate active learning', 'content', 'Activities, scenarios', 'Yes'],
  ['AI Modes', 'POST', '/api/intuitive-learning/generate', 'Generate concept constellation', 'content', 'Patterns, insights', 'Yes'],
  ['AI Modes', 'POST', '/api/sensing-learning/generate', 'Generate hands-on lab', 'content', 'Simulations, challenges', 'Yes'],
  ['AI Modes', 'POST', '/api/global-learning/generate', 'Generate global view', 'content', 'Big picture, connections', 'Yes'],
  ['AI Modes', 'POST', '/api/sequential-learning/generate', 'Generate sequential steps', 'content', 'Step-by-step flow', 'Yes'],
  ['AI Modes', 'POST', '/api/reflective-learning/generate', 'Generate reflective content', 'content', 'Deep questions, analysis', 'Yes'],
  [''],
  ['Files', 'POST', '/api/upload', 'Upload file', 'FormData (file)', 'File URL (Backblaze B2)', 'Yes'],
  ['Files', 'GET', '/api/secure-file', 'Get secure file', 'fileUrl', 'Signed URL', 'Yes'],
  ['Files', 'POST', '/api/pdf-extract', 'Extract PDF text', 'fileUrl', 'Extracted text', 'Yes'],
  ['Files', 'POST', '/api/docx-extract', 'Extract DOCX text', 'fileUrl', 'Extracted text', 'Yes'],
  ['Files', 'POST', '/api/generate-thumbnail', 'Generate thumbnail', 'fileUrl, fileType', 'Thumbnail URL', 'Yes'],
  [''],
  ['Schedule', 'GET', '/api/schedule', 'Get schedules', 'None', 'Array of schedules', 'Yes'],
  ['Schedule', 'POST', '/api/schedule', 'Create schedule', 'Schedule data', 'New schedule', 'Yes'],
];

const ws_api = XLSX.utils.aoa_to_sheet(apiData);
ws_api['!cols'] = [{ wch: 20 }, { wch: 8 }, { wch: 40 }, { wch: 35 }, { wch: 35 }, { wch: 35 }, { wch: 12 }];
XLSX.utils.book_append_sheet(wb, ws_api, 'API Endpoints');

// Sheet 7: Technology Stack
const techStackData = [
  ['COMPLETE TECHNOLOGY STACK'],
  [''],
  ['Category', 'Technology', 'Version', 'Purpose', 'Key Features'],
  ['Frontend Framework', 'Next.js', '15.4.6', 'React framework with SSR/SSG', 'App Router, Server Components, API Routes'],
  ['Frontend Library', 'React', '19.1.0', 'UI component library', 'Hooks, Context API, Suspense'],
  ['Styling', 'TailwindCSS', '3.4.17', 'Utility-first CSS framework', 'Responsive design, Custom themes'],
  ['Animation', 'Framer Motion', '12.23.22', 'Animation library', 'Smooth transitions, Gestures'],
  ['Icons', 'Heroicons', '2.2.0', 'Icon library', 'Outline and solid variants'],
  [''],
  ['Backend Runtime', 'Node.js', '18+', 'JavaScript runtime', 'Event-driven, Non-blocking I/O'],
  ['Database', 'MongoDB', '6.18.0', 'NoSQL database', 'Document-based, Flexible schema'],
  ['ODM', 'Mongoose', '8.17.1', 'MongoDB object modeling', 'Schema validation, Middleware'],
  ['Authentication', 'JWT', '9.0.2', 'Token-based auth', 'Stateless, Secure, httpOnly cookies'],
  ['Firebase Auth', 'Firebase', '12.1.0', 'Authentication service', 'Google Sign-In, Email verification'],
  [''],
  ['AI Services', 'Google Gemini AI', 'Latest', 'Content generation', 'Text generation, Analysis, Classification'],
  ['AI Services', 'Google TTS', 'Latest', 'Text-to-speech', 'Audio narration in multiple languages'],
  ['ML Framework', 'XGBoost', 'Python', 'Machine learning', 'Gradient boosting, High accuracy'],
  ['ML Service', 'Flask', 'Python', 'ML API server', 'RESTful API, Model serving'],
  ['ML Libraries', 'scikit-learn', 'Python', 'ML utilities', 'Feature engineering, Validation'],
  ['ML Libraries', 'pandas', 'Python', 'Data manipulation', 'DataFrames, Analysis'],
  ['ML Libraries', 'numpy', 'Python', 'Numerical computing', 'Arrays, Mathematical operations'],
  [''],
  ['Cloud Storage', 'Backblaze B2', 'S3-compatible', 'Primary file storage', 'Course materials, Documents, Thumbnails'],
  ['Cloud Storage', 'Firebase Storage', 'Latest', 'Profile photo storage', 'Admin profile pictures only'],
  [''],
  ['Document Processing', 'pdf-parse', '1.1.1', 'PDF text extraction', 'Parse PDF content'],
  ['Document Processing', 'mammoth', '1.11.0', 'DOCX to HTML conversion', 'Extract DOCX content'],
  ['Document Processing', 'Pandoc', 'System', 'Document conversion', 'DOCX to HTML'],
  ['Document Processing', 'LibreOffice', 'System', 'PPTX conversion', 'PPTX to PDF/images'],
  ['Document Processing', 'Poppler Utils', 'System', 'PDF operations', 'PDF to images, Metadata'],
  ['Document Processing', 'Sharp', '0.34.4', 'Image processing', 'Resize, Optimize, Convert'],
  [''],
  ['Email Service', 'Nodemailer', '7.0.5', 'Email sending', 'OTP verification, Notifications'],
  ['Date Handling', 'date-fns', '4.1.0', 'Date utilities', 'Formatting, Calculations'],
  ['File Upload', 'Multer', '2.0.2', 'File upload middleware', 'Handle multipart/form-data'],
  ['HTTP Client', 'Fetch API', 'Native', 'HTTP requests', 'RESTful API calls'],
  [''],
  ['Development', 'ESLint', '9', 'Code linting', 'Code quality, Best practices'],
  ['Development', 'PostCSS', '8.5.6', 'CSS processing', 'Autoprefixer, Transformations'],
  ['Development', 'Turbopack', 'Built-in', 'Fast bundler', 'Development speed'],
];

const ws_tech = XLSX.utils.aoa_to_sheet(techStackData);
ws_tech['!cols'] = [{ wch: 25 }, { wch: 25 }, { wch: 15 }, { wch: 35 }, { wch: 50 }];
XLSX.utils.book_append_sheet(wb, ws_tech, 'Technology Stack');

// Sheet 8: User Roles & Permissions
const rolesData = [
  ['USER ROLES & PERMISSIONS MATRIX'],
  [''],
  ['Feature/Action', 'Guest', 'Student', 'Instructor', 'Admin', 'Notes'],
  ['View Landing Page', 'Yes', 'Yes', 'Yes', 'Yes', 'Public access'],
  ['Register Account', 'Yes', 'N/A', 'N/A', 'N/A', 'Becomes Student after registration'],
  ['Login', 'Yes', 'Yes', 'Yes', 'Yes', 'All registered users'],
  [''],
  ['View Home Dashboard', 'No', 'Yes', 'Yes', 'Yes', 'Authenticated only'],
  ['Take Learning Style Quiz', 'No', 'Yes', 'Yes', 'Yes', 'One-time, can retake'],
  ['View Learning Style Profile', 'No', 'Yes', 'Yes', 'Yes', 'Own profile only'],
  [''],
  ['Browse Courses', 'No', 'Yes', 'Yes', 'Yes', 'See enrolled/created courses'],
  ['Create Course', 'No', 'No', 'Yes', 'Yes', 'Becomes course creator'],
  ['Join Course', 'No', 'Yes', 'Yes', 'Yes', 'With valid course code'],
  ['Edit Course', 'No', 'No', 'Yes (Own)', 'Yes (All)', 'Creator or admin only'],
  ['Delete/Archive Course', 'No', 'No', 'Yes (Own)', 'Yes (All)', 'Creator or admin only'],
  ['Leave Course', 'No', 'Yes', 'No', 'No', 'Students can leave enrolled courses'],
  [''],
  ['View Course Stream', 'No', 'Yes (Enrolled)', 'Yes (Own)', 'Yes', 'Course members only'],
  ['Post Announcement', 'No', 'No', 'Yes (Own)', 'Yes', 'Instructors only'],
  ['Comment on Posts', 'No', 'Yes (Enrolled)', 'Yes (Own)', 'Yes', 'Course members'],
  ['Delete Announcement', 'No', 'No', 'Yes (Own)', 'Yes', 'Creator of announcement or admin'],
  [''],
  ['View Classwork', 'No', 'Yes (Enrolled)', 'Yes (Own)', 'Yes', 'Course members'],
  ['Create Assignment', 'No', 'No', 'Yes (Own)', 'Yes', 'Instructors only'],
  ['Edit Assignment', 'No', 'No', 'Yes (Own)', 'Yes', 'Creator or admin'],
  ['Delete Assignment', 'No', 'No', 'Yes (Own)', 'Yes', 'Creator or admin'],
  ['Submit Assignment', 'No', 'Yes (Enrolled)', 'No', 'No', 'Students only'],
  ['Grade Submissions', 'No', 'No', 'Yes (Own)', 'Yes', 'Instructors only'],
  ['View All Submissions', 'No', 'No', 'Yes (Own)', 'Yes', 'Instructors see all, students see own'],
  [''],
  ['View Course Members', 'No', 'Yes (Enrolled)', 'Yes (Own)', 'Yes', 'Course members'],
  ['Invite Members', 'No', 'No', 'Yes (Own)', 'Yes', 'Instructors only'],
  ['Remove Members', 'No', 'No', 'Yes (Own)', 'Yes', 'Instructors only'],
  [''],
  ['Open Documents', 'No', 'Yes (Enrolled)', 'Yes (Own)', 'Yes', 'Course materials'],
  ['Use AI Learning Modes', 'No', 'Yes', 'Yes', 'Yes', 'All 8 modes available'],
  ['View AI Recommendations', 'No', 'Yes', 'Yes', 'Yes', 'Based on learning style'],
  [''],
  ['Upload Files', 'No', 'Yes (Enrolled)', 'Yes', 'Yes', 'Course materials, submissions'],
  ['Download Files', 'No', 'Yes (Enrolled)', 'Yes', 'Yes', 'Course materials'],
  [''],
  ['View Schedule', 'No', 'Yes', 'Yes', 'Yes', 'Own courses only'],
  ['Create Schedule', 'No', 'No', 'Yes (Own)', 'Yes', 'For own courses'],
  [''],
  ['Update Profile', 'No', 'Yes (Own)', 'Yes (Own)', 'Yes (Own)', 'Own profile only'],
  ['Change Password', 'No', 'Yes (Own)', 'Yes (Own)', 'Yes (Own)', 'Own account only'],
  ['Upload Profile Picture', 'No', 'Yes (Own)', 'Yes (Own)', 'Yes (Own)', 'Own profile only'],
  [''],
  ['Access Admin Panel', 'No', 'No', 'No', 'Yes', 'Admin only'],
  ['Manage All Users', 'No', 'No', 'No', 'Yes', 'Admin only'],
  ['Manage All Courses', 'No', 'No', 'No', 'Yes', 'Admin only'],
  ['View System Analytics', 'No', 'No', 'No', 'Yes', 'Admin only'],
  ['System Configuration', 'No', 'No', 'No', 'Yes', 'Admin only'],
];

const ws_roles = XLSX.utils.aoa_to_sheet(rolesData);
ws_roles['!cols'] = [{ wch: 35 }, { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 40 }];
XLSX.utils.book_append_sheet(wb, ws_roles, 'User Roles & Permissions');

// Sheet 9: Database Schema
const schemaData = [
  ['DATABASE SCHEMA - MONGODB COLLECTIONS'],
  [''],
  ['Collection: users'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique user identifier', 'Auto-generated'],
  ['name', 'String', 'Yes', 'First name', 'John'],
  ['middleName', 'String', 'No', 'Middle name', 'Michael'],
  ['surname', 'String', 'Yes', 'Last name', 'Doe'],
  ['suffix', 'String', 'No', 'Name suffix', 'Jr.'],
  ['email', 'String', 'Yes', 'Email address (unique)', 'john.doe@example.com'],
  ['password', 'String', 'Yes', 'Hashed password (bcrypt)', 'Hashed string'],
  ['profilePicture', 'String', 'No', 'Profile photo URL', 'Firebase Storage URL'],
  ['role', 'String', 'Yes', 'User role', 'student, instructor, admin'],
  ['isVerified', 'Boolean', 'Yes', 'Email verification status', 'true/false'],
  ['otp', 'String', 'No', 'Verification OTP', '6-digit code'],
  ['otpExpiry', 'Date', 'No', 'OTP expiration time', 'Timestamp'],
  ['createdAt', 'Date', 'Yes', 'Account creation date', 'Auto-generated'],
  ['updatedAt', 'Date', 'Yes', 'Last update date', 'Auto-generated'],
  [''],
  ['Collection: courses'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique course identifier', 'Auto-generated'],
  ['subject', 'String', 'Yes', 'Course name/title', 'Introduction to AI'],
  ['section', 'String', 'Yes', 'Course code/section', 'CS-101'],
  ['teacherName', 'String', 'Yes', 'Instructor name', 'Dr. Smith'],
  ['createdBy', 'ObjectId', 'Yes', 'Creator user ID (ref: users)', 'User ObjectId'],
  ['coverColor', 'String', 'Yes', 'Course theme color', '#60a5fa'],
  ['enrolledUsers', 'Array[ObjectId]', 'Yes', 'Enrolled student IDs', 'Array of user IDs'],
  ['coTeachers', 'Array[ObjectId]', 'No', 'Co-instructor IDs', 'Array of user IDs'],
  ['customOrder', 'Number', 'No', 'Display order', '0, 1, 2...'],
  ['schedules', 'Array[Object]', 'No', 'Course schedules', 'Array of schedule objects'],
  ['isArchived', 'Boolean', 'Yes', 'Archive status', 'false'],
  ['createdAt', 'Date', 'Yes', 'Creation date', 'Auto-generated'],
  ['updatedAt', 'Date', 'Yes', 'Last update date', 'Auto-generated'],
  [''],
  ['Collection: classwork'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique classwork identifier', 'Auto-generated'],
  ['courseId', 'ObjectId', 'Yes', 'Parent course ID (ref: courses)', 'Course ObjectId'],
  ['title', 'String', 'Yes', 'Assignment title', 'Chapter 1 Quiz'],
  ['description', 'String', 'No', 'Assignment description', 'Complete all questions'],
  ['type', 'String', 'Yes', 'Type of classwork', 'assignment, quiz, material'],
  ['dueDate', 'Date', 'No', 'Submission deadline', 'Timestamp'],
  ['points', 'Number', 'No', 'Maximum points', '100'],
  ['attachments', 'Array[Object]', 'No', 'File attachments', 'Array of file objects'],
  ['createdBy', 'ObjectId', 'Yes', 'Creator user ID', 'User ObjectId'],
  ['createdAt', 'Date', 'Yes', 'Creation date', 'Auto-generated'],
  ['updatedAt', 'Date', 'Yes', 'Last update date', 'Auto-generated'],
  [''],
  ['Collection: submissions'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique submission identifier', 'Auto-generated'],
  ['classworkId', 'ObjectId', 'Yes', 'Parent classwork ID', 'Classwork ObjectId'],
  ['studentId', 'ObjectId', 'Yes', 'Student user ID', 'User ObjectId'],
  ['content', 'String', 'No', 'Submission text', 'Answer text'],
  ['attachments', 'Array[Object]', 'No', 'Submitted files', 'Array of file objects'],
  ['grade', 'Number', 'No', 'Assigned grade', '85'],
  ['feedback', 'String', 'No', 'Instructor feedback', 'Good work!'],
  ['status', 'String', 'Yes', 'Submission status', 'submitted, graded, late'],
  ['submittedAt', 'Date', 'Yes', 'Submission timestamp', 'Auto-generated'],
  ['gradedAt', 'Date', 'No', 'Grading timestamp', 'Timestamp'],
  [''],
  ['Collection: announcements'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique announcement identifier', 'Auto-generated'],
  ['courseId', 'ObjectId', 'Yes', 'Parent course ID', 'Course ObjectId'],
  ['content', 'String', 'Yes', 'Announcement text', 'Class tomorrow at 9 AM'],
  ['postedBy', 'ObjectId', 'Yes', 'Poster user ID', 'User ObjectId'],
  ['attachments', 'Array[Object]', 'No', 'File attachments', 'Array of file objects'],
  ['comments', 'Array[Object]', 'No', 'Comments on announcement', 'Array of comment objects'],
  ['createdAt', 'Date', 'Yes', 'Post date', 'Auto-generated'],
  ['updatedAt', 'Date', 'Yes', 'Last update date', 'Auto-generated'],
  [''],
  ['Collection: learningStyleProfiles'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique profile identifier', 'Auto-generated'],
  ['userId', 'ObjectId', 'Yes', 'User ID (ref: users)', 'User ObjectId'],
  ['activeReflective', 'Number', 'Yes', 'FSLSM score (-11 to +11)', '+7'],
  ['sensingIntuitive', 'Number', 'Yes', 'FSLSM score (-11 to +11)', '+3'],
  ['visualVerbal', 'Number', 'Yes', 'FSLSM score (-11 to +11)', '+9'],
  ['sequentialGlobal', 'Number', 'Yes', 'FSLSM score (-11 to +11)', '+5'],
  ['classificationMethod', 'String', 'Yes', 'How it was determined', 'questionnaire, ml, hybrid'],
  ['confidence', 'Number', 'Yes', 'Classification confidence', '0.88 (88%)'],
  ['questionnaireResponses', 'Object', 'No', 'Original questionnaire answers', 'Response object'],
  ['lastClassified', 'Date', 'Yes', 'Last classification date', 'Timestamp'],
  ['createdAt', 'Date', 'Yes', 'Profile creation date', 'Auto-generated'],
  ['updatedAt', 'Date', 'Yes', 'Last update date', 'Auto-generated'],
  [''],
  ['Collection: learningBehaviors'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique behavior record identifier', 'Auto-generated'],
  ['userId', 'ObjectId', 'Yes', 'User ID (ref: users)', 'User ObjectId'],
  ['modeType', 'String', 'Yes', 'AI mode used', 'visual, active, reflective, etc.'],
  ['duration', 'Number', 'Yes', 'Time spent (seconds)', '300'],
  ['interactionCount', 'Number', 'Yes', 'Number of interactions', '15'],
  ['contentType', 'String', 'Yes', 'Type of content', 'pdf, docx, pptx'],
  ['metadata', 'Object', 'No', 'Additional behavior data', 'Custom object'],
  ['timestamp', 'Date', 'Yes', 'Behavior timestamp', 'Auto-generated'],
  [''],
  ['Collection: schedules'],
  ['Field', 'Type', 'Required', 'Description', 'Example'],
  ['_id', 'ObjectId', 'Yes', 'Unique schedule identifier', 'Auto-generated'],
  ['courseId', 'ObjectId', 'Yes', 'Parent course ID', 'Course ObjectId'],
  ['dayOfWeek', 'String', 'Yes', 'Day of week', 'Monday, Tuesday, etc.'],
  ['startTime', 'String', 'Yes', 'Class start time', '09:00'],
  ['endTime', 'String', 'Yes', 'Class end time', '10:30'],
  ['room', 'String', 'No', 'Room/location', 'Room 301'],
  ['createdAt', 'Date', 'Yes', 'Creation date', 'Auto-generated'],
];

const ws_schema = XLSX.utils.aoa_to_sheet(schemaData);
ws_schema['!cols'] = [{ wch: 30 }, { wch: 20 }, { wch: 12 }, { wch: 40 }, { wch: 30 }];
XLSX.utils.book_append_sheet(wb, ws_schema, 'Database Schema');

// Sheet 10: Key Metrics & Statistics
const metricsData = [
  ['SYSTEM METRICS & PERFORMANCE STATISTICS'],
  [''],
  ['MACHINE LEARNING PERFORMANCE'],
  ['Metric', 'Value', 'Description'],
  ['ML Model Accuracy', '88%', 'R¬≤ score on validation dataset'],
  ['Training Dataset Size', '2,500+ samples', 'Number of labeled training examples'],
  ['Features Tracked', '24', 'Behavioral features across 4 FSLSM dimensions'],
  ['Classification Models', '4', 'One model per FSLSM dimension'],
  ['Questionnaire Accuracy', '60-70%', 'Self-reported questionnaire baseline'],
  ['ML Improvement', '+18-28%', 'Accuracy gain over questionnaire alone'],
  ['Cold Start Solution', 'Questionnaire', 'Immediate classification for new users'],
  ['Adaptation Time', '2-3 weeks', 'Time to collect sufficient behavioral data'],
  [''],
  ['LEARNING STYLE MODEL (FSLSM)'],
  ['Dimension', 'Questions', 'Score Range', 'Interpretation'],
  ['Active ‚Üî Reflective', '5', '-11 to +11', 'Negative = Active, Positive = Reflective'],
  ['Sensing ‚Üî Intuitive', '5', '-11 to +11', 'Negative = Sensing, Positive = Intuitive'],
  ['Visual ‚Üî Verbal', '5', '-11 to +11', 'Negative = Visual, Positive = Verbal'],
  ['Sequential ‚Üî Global', '5', '-11 to +11', 'Negative = Sequential, Positive = Global'],
  ['Total Questions', '20', 'N/A', '5 questions per dimension'],
  ['Completion Time', '5 minutes', 'N/A', 'Average time to complete questionnaire'],
  [''],
  ['AI LEARNING MODES USAGE'],
  ['Mode', 'Icon', 'Primary FSLSM Dimension', 'Avg. Session Duration', 'Engagement Rate'],
  ['AI Narrator', 'üéß', 'Verbal', '15-20 min', 'High'],
  ['Visual Learning', 'üìä', 'Visual', '10-15 min', 'Very High'],
  ['Active Learning Hub', 'üéØ', 'Active', '20-30 min', 'Very High'],
  ['Concept Constellation', 'üîÆ', 'Intuitive', '15-25 min', 'Medium'],
  ['Hands-On Lab', 'üî¨', 'Sensing', '25-40 min', 'High'],
  ['Global Learning', 'üåç', 'Global', '10-15 min', 'Medium'],
  ['Sequential Learning', 'üìã', 'Sequential', '15-25 min', 'High'],
  ['Reflective Learning', 'ü§î', 'Reflective', '20-35 min', 'Medium-High'],
  [''],
  ['SYSTEM PERFORMANCE'],
  ['Metric', 'Value', 'Notes'],
  ['Average Page Load Time', '< 2 seconds', 'With caching enabled'],
  ['API Response Time', '< 500ms', 'Average for most endpoints'],
  ['AI Content Generation', '5-15 seconds', 'Depends on content complexity'],
  ['ML Classification Time', '< 1 second', 'Once behavioral data is collected'],
  ['File Upload Speed', 'Varies', 'Depends on file size and network'],
  ['Document Processing', '2-10 seconds', 'PDF/DOCX/PPTX extraction'],
  [''],
  ['USER ENGAGEMENT METRICS'],
  ['Metric', 'Target', 'Description'],
  ['Daily Active Users', 'Track', 'Users who login daily'],
  ['Course Completion Rate', '> 70%', 'Students who complete enrolled courses'],
  ['AI Mode Usage Rate', '> 80%', 'Students who use at least one AI mode'],
  ['Assignment Submission Rate', '> 85%', 'On-time submission percentage'],
  ['Average Session Duration', '25-35 min', 'Time spent per learning session'],
  ['Return User Rate', '> 75%', 'Users who return within 7 days'],
  [''],
  ['CONTENT STATISTICS'],
  ['Content Type', 'Supported Formats', 'AI Modes Available', 'Processing Time'],
  ['Documents', 'PDF, DOCX, PPTX', 'All 8 modes', '2-10 seconds'],
  ['Text Content', 'Plain text, Markdown', 'All 8 modes', '< 1 second'],
  ['Images', 'JPG, PNG, GIF', 'Visual Learning only', '1-3 seconds'],
  ['Audio', 'MP3, WAV', 'AI Narrator only', 'N/A (playback)'],
  [''],
  ['STORAGE METRICS'],
  ['Storage Type', 'Provider', 'Usage', 'Purpose'],
  ['Primary Storage', 'Backblaze B2', 'Course materials', 'PDF, DOCX, PPTX, thumbnails'],
  ['Profile Photos', 'Firebase Storage', 'Admin profiles', 'Profile pictures only'],
  ['Database', 'MongoDB Atlas', 'All data', 'Users, courses, submissions, etc.'],
  ['Cache', 'In-memory', 'Temporary', 'API responses, document content'],
  [''],
  ['SECURITY METRICS'],
  ['Security Feature', 'Implementation', 'Status'],
  ['Authentication', 'JWT + httpOnly cookies', 'Active'],
  ['Password Hashing', 'bcrypt (10 rounds)', 'Active'],
  ['Email Verification', 'OTP (6 digits, 10 min expiry)', 'Active'],
  ['API Rate Limiting', 'To be implemented', 'Planned'],
  ['CORS Protection', 'Configured', 'Active'],
  ['XSS Protection', 'React built-in', 'Active'],
  ['CSRF Protection', 'httpOnly cookies', 'Active'],
  ['File Upload Validation', 'Type and size checks', 'Active'],
];

const ws_metrics = XLSX.utils.aoa_to_sheet(metricsData);
ws_metrics['!cols'] = [{ wch: 30 }, { wch: 25 }, { wch: 25 }, { wch: 30 }, { wch: 20 }];
XLSX.utils.book_append_sheet(wb, ws_metrics, 'Metrics & Statistics');

// Sheet 11: Setup & Deployment
const setupData = [
  ['SYSTEM SETUP & DEPLOYMENT GUIDE'],
  [''],
  ['PREREQUISITES'],
  ['Requirement', 'Version', 'Purpose', 'Installation'],
  ['Node.js', '18.x or higher', 'JavaScript runtime', 'https://nodejs.org/'],
  ['npm', 'Latest', 'Package manager', 'Comes with Node.js'],
  ['MongoDB', 'Latest', 'Database', 'Local or MongoDB Atlas'],
  ['Python', '3.8 or higher', 'ML service', 'https://python.org/'],
  ['Pandoc', 'Latest', 'DOCX conversion', 'https://pandoc.org/'],
  ['LibreOffice', 'Latest', 'PPTX conversion', 'https://libreoffice.org/'],
  ['Poppler Utils', 'Latest', 'PDF operations', 'System package manager'],
  [''],
  ['INSTALLATION STEPS'],
  ['Step', 'Command/Action', 'Description'],
  ['1', 'git clone <repository-url>', 'Clone the repository'],
  ['2', 'cd adaptive-learning-platform', 'Navigate to project directory'],
  ['3', 'npm install', 'Install Node.js dependencies'],
  ['4', 'Copy .env.local.example to .env.local', 'Create environment file'],
  ['5', 'Configure .env.local', 'Add API keys and database URLs'],
  ['6', 'npm run check-deps', 'Verify system dependencies'],
  ['7', 'scripts\\setup-ml.bat', 'Setup Python ML environment'],
  ['8', 'npm run dev', 'Start development server (Terminal 1)'],
  ['9', 'scripts\\start-ml-service.bat', 'Start ML service (Terminal 2)'],
  ['10', 'Open http://localhost:3000', 'Access the application'],
  [''],
  ['ENVIRONMENT VARIABLES'],
  ['Variable', 'Required', 'Description', 'Example'],
  ['MONGODB_URI', 'Yes', 'MongoDB connection string', 'mongodb://localhost:27017/intelevo'],
  ['JWT_SECRET', 'Yes', 'Secret key for JWT tokens', 'your-secret-key-here'],
  ['GOOGLE_API_KEY', 'Yes', 'Google Gemini AI API key', 'AIza...'],
  ['B2_ENDPOINT', 'Yes', 'Backblaze B2 endpoint', 'https://s3.us-east-005.backblazeb2.com'],
  ['B2_KEY_ID', 'Yes', 'Backblaze B2 key ID', 'Your key ID'],
  ['B2_APPLICATION_KEY', 'Yes', 'Backblaze B2 application key', 'Your application key'],
  ['B2_BUCKET_NAME', 'Yes', 'Backblaze B2 bucket name', 'your-bucket-name'],
  ['NEXT_PUBLIC_FIREBASE_API_KEY', 'Yes', 'Firebase API key', 'AIza...'],
  ['NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN', 'Yes', 'Firebase auth domain', 'your-project.firebaseapp.com'],
  ['NEXT_PUBLIC_FIREBASE_PROJECT_ID', 'Yes', 'Firebase project ID', 'your-project-id'],
  ['NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET', 'Yes', 'Firebase storage bucket', 'your-project.appspot.com'],
  ['NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID', 'Yes', 'Firebase messaging sender ID', '123456789'],
  ['NEXT_PUBLIC_FIREBASE_APP_ID', 'Yes', 'Firebase app ID', '1:123456789:web:abc123'],
  ['NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID', 'Yes', 'Firebase measurement ID', 'G-XXXXXXXXXX'],
  ['EMAIL_HOST', 'Optional', 'SMTP host for emails', 'smtp.gmail.com'],
  ['EMAIL_PORT', 'Optional', 'SMTP port', '587'],
  ['EMAIL_USER', 'Optional', 'SMTP username', 'your-email@gmail.com'],
  ['EMAIL_PASSWORD', 'Optional', 'SMTP password', 'your-app-password'],
  [''],
  ['DEPLOYMENT OPTIONS'],
  ['Platform', 'Suitable For', 'Steps', 'Notes'],
  ['Vercel', 'Next.js app', '1. Connect GitHub repo, 2. Configure env vars, 3. Deploy', 'Recommended for frontend'],
  ['Render', 'Full stack', '1. Create web service, 2. Add env vars, 3. Deploy', 'Current deployment'],
  ['Heroku', 'Full stack', '1. Create app, 2. Add buildpacks, 3. Deploy', 'Good for prototypes'],
  ['AWS', 'Production', '1. Setup EC2/ECS, 2. Configure RDS, 3. Deploy', 'Most scalable'],
  ['DigitalOcean', 'VPS hosting', '1. Create droplet, 2. Setup environment, 3. Deploy', 'Good balance'],
  [''],
  ['ML SERVICE DEPLOYMENT'],
  ['Step', 'Action', 'Description'],
  ['1', 'Install Python dependencies', 'pip install -r ml-service/requirements.txt'],
  ['2', 'Verify models exist', 'Check ml-service/models/ directory'],
  ['3', 'Start Flask service', 'python ml-service/app.py'],
  ['4', 'Test endpoint', 'curl http://localhost:5000/health'],
  ['5', 'Configure production server', 'Use gunicorn or similar WSGI server'],
  [''],
  ['PRODUCTION CHECKLIST'],
  ['Item', 'Status', 'Notes'],
  ['Environment variables configured', '‚òê', 'All required vars set'],
  ['Database connection tested', '‚òê', 'MongoDB accessible'],
  ['Cloud storage configured', '‚òê', 'Backblaze B2 + Firebase'],
  ['Email service configured', '‚òê', 'SMTP settings correct'],
  ['System dependencies installed', '‚òê', 'Pandoc, LibreOffice, Poppler'],
  ['ML service running', '‚òê', 'Flask server on port 5000'],
  ['SSL certificate installed', '‚òê', 'HTTPS enabled'],
  ['Domain configured', '‚òê', 'DNS settings correct'],
  ['Backup strategy implemented', '‚òê', 'Database and file backups'],
  ['Monitoring setup', '‚òê', 'Error tracking, analytics'],
  ['Rate limiting configured', '‚òê', 'API protection'],
  ['CORS settings verified', '‚òê', 'Allowed origins configured'],
];

const ws_setup = XLSX.utils.aoa_to_sheet(setupData);
ws_setup['!cols'] = [{ wch: 35 }, { wch: 25 }, { wch: 50 }, { wch: 40 }];
XLSX.utils.book_append_sheet(wb, ws_setup, 'Setup & Deployment');

// Write the file
const outputPath = path.join(__dirname, '..', 'INTELEVO_USER_JOURNEY_COMPLETE.xlsx');
XLSX.writeFile(wb, outputPath);

console.log('‚úÖ Excel file generated successfully!');
console.log(`üìÅ Location: ${outputPath}`);
console.log('');
console.log('üìä Sheets included:');
console.log('  1. System Overview');
console.log('  2. User Journey Flow');
console.log('  3. 8 AI Learning Modes');
console.log('  4. ML Classification System');
console.log('  5. Pages & Routes');
console.log('  6. API Endpoints');
console.log('  7. Technology Stack');
console.log('  8. User Roles & Permissions');
console.log('  9. Database Schema');
console.log(' 10. Metrics & Statistics');
console.log(' 11. Setup & Deployment');
console.log('');
console.log('üéâ Ready for your capstone defense!');
